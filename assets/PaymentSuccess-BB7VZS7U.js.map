{"version":3,"file":"PaymentSuccess-BB7VZS7U.js","sources":["../../../src/base/core/views/PaymentSuccess.vue"],"sourcesContent":["<template>\r\n  <BaseLayout wrapperClass=\"paymentInfo\">\r\n    <section class=\"static pt-7\">\r\n      <BContainer>\r\n        <BRow>\r\n          <BCol lg=\"3\" class=\"d-none d-lg-block\">\r\n            <SidebarLinks />\r\n          </BCol>\r\n          <BCol lg=\"9\">\r\n            <h1>{{ $t(\"payment_success\") }}</h1>\r\n            <div v-if=\"transactionId != null\">\r\n              {{ $t(\"transaction\") }}: {{ \"#\" + transactionId }}\r\n            </div>\r\n            <cmsBlockSimple identifier=\"checkout_succes\" />\r\n          </BCol>\r\n        </BRow>\r\n      </BContainer>\r\n    </section>\r\n  </BaseLayout>\r\n</template>\r\n\r\n<script setup>\r\nimport { onMounted, ref, computed } from \"vue\";\r\nimport { useRouter, useRoute } from \"vue-router\";\r\nimport { useStore } from \"vuex\";\r\nimport { useI18n } from \"vue-i18n\";\r\nimport { useHead } from \"@unhead/vue\";\r\nimport BaseLayout from \"@/base/core/components/common/BaseLayout\";\r\nimport SidebarLinks from \"@/base/core/components/SidebarLinks\";\r\nimport cmsBlockSimple from \"@/base/core/components/core/BlockSimple\";\r\nimport { getOrderInfoFromHash } from \"@storefront/core/data-resolver/cart\";\r\nimport config from \"@storefront/core/lib/utils/config\";\r\nimport { useGtm } from \"@gtm-support/vue-gtm\";\r\n\r\nconst store = useStore();\r\nconst router = useRouter();\r\nconst route = useRoute();\r\nconst { t } = useI18n();\r\nconst gtm = useGtm();\r\n\r\n// Set up meta information using useHead\r\nuseHead({\r\n  title: () => t(\"payment_success\"),\r\n  meta: [\r\n    { name: \"title\", content: () => t(\"payment_success\") },\r\n    { name: \"keywords\", content: () => t(\"payment_success\") },\r\n    { name: \"description\", content: () => t(\"payment_success\") },\r\n  ],\r\n});\r\n\r\n// orderId is not define\r\nconst orderId = ref(null);\r\n\r\n// Computed properties\r\nconst transactionId = computed(() => {\r\n  return route.query.transactionid !== undefined ? route.query.transactionid : null;\r\n});\r\n\r\n// Mounted\r\nonMounted(async () => {\r\n  const bcrumb = { current: \"success\", routes: [] };\r\n  store.commit(\"breadcrumbs/set\", bcrumb);\r\n\r\n  const hashId = localStorage.getItem(\"orderHash\");\r\n  if (hashId) {\r\n    const order = await getOrderInfoFromHash(hashId, store);\r\n    if (order) {\r\n      orderId.value = order.number;\r\n\r\n      if (gtm.enabled()) {\r\n        const items = [];\r\n        const prods = [];\r\n        order.items.forEach((element) => {\r\n          items.push({\r\n            id: element.product_sku,\r\n            name: element.product_name,\r\n            price: element.product_sale_price,\r\n            quantity: element.quantity_ordered,\r\n          });\r\n          prods.push({\r\n            item_id: element.product_sku,\r\n            item_name: element.product_name,\r\n            price: element.product_sale_price,\r\n            quantity: element.quantity_ordered,\r\n          });\r\n        });\r\n\r\n        if (!gtm.uaDisabled) {\r\n          // GA Universal Analytics event\r\n          window.dataLayer.push({\r\n            event: \"purchase\",\r\n            ecommerce: {\r\n              currencyCode: \"EUR\",\r\n              purchase: {\r\n                actionField: {\r\n                  id: order.number,\r\n                  affiliation: config.app_name,\r\n                  revenue: order.total.subtotal.value,\r\n                  tax: order.total.total_tax.value,\r\n                  shipping: order.total.total_shipping.value,\r\n                },\r\n                products: items,\r\n              },\r\n            },\r\n          });\r\n        }\r\n\r\n        if (gtm.ga4Enabled) {\r\n          // GA4 event\r\n          window.dataLayer.push({\r\n            event: \"purchase\",\r\n            ecommerce: {\r\n              add: {\r\n                transaction_id: order.number,\r\n                affiliation: config.app_name,\r\n                value: order.total.subtotal.value,\r\n                tax: order.total.total_tax.value,\r\n                shipping: order.total.total_shipping.value,\r\n                items: prods,\r\n              },\r\n            },\r\n          });\r\n        }\r\n\r\n        if (config.helloRetail?.enabled) {\r\n          const hritems = order.items.map((item) => item.product_sku);\r\n          window.ADDWISH_PARTNER_NS.api.conversion.track_sale(\r\n            {\r\n              total: order.total.subtotal.value,\r\n              orderNumber: order.number,\r\n              productNumbers: hritems,\r\n            },\r\n            () => {\r\n              // Conversion tracked for Hello Retail\r\n            }\r\n          );\r\n        }\r\n      }\r\n    }\r\n  }\r\n});\r\n</script>\r\n"],"names":["config"],"mappings":"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"}