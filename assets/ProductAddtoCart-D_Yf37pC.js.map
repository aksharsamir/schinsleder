{"version":3,"file":"ProductAddtoCart-D_Yf37pC.js","sources":["../../../src/esf_thehague_schinsleder/core/components/product/ProductAddtoCart.vue"],"sourcesContent":["<template>\r\n  <div class=\"d-flex quantity-and-btn\">\r\n    <div class=\"quantity-input d-flex\">\r\n      <input type=\"text\" min=\"1\" :value=\"quantity\"  pattern= \"[0-9]+\"  name=\"quantity\" ref=\"inputQuantity\" disabled />\r\n      <BButton variant=\"secondary\" class=\"step-down-btn text-white\" @click.revent=\"quantityDown\">-</BButton>\r\n      <BButton variant=\"secondary\" class=\"step-up-btn text-white\" @click.prevent=\"quantityUp\">+</BButton>\r\n    </div>\r\n    <BButton variant=\"secondary\" @click.prevent=\"addToCart\" :disabled=\"btnDisable || isAddToCartBtnDisabled\" :style=\"buttonClass\"\r\n      class=\"text-white product-parameter-submit-btn\">{{ $t(\"add_to_cart\") }}\r\n    </BButton>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { computed, ref, watch } from \"vue\";\r\nimport { useStore } from \"vuex\";\r\nimport { useI18n } from \"vue-i18n\";\r\nimport config from \"@storefront/core/lib/utils/config\";\r\nimport { useGtm } from \"@gtm-support/vue-gtm\";\r\nimport { BButton, useModal } from \"bootstrap-vue-next\";\r\n\r\nconst props = defineProps({\r\n  product: Object,\r\n  productConfig: Object,\r\n  addedQuantity: Function,\r\n});\r\n\r\nconst store = useStore();\r\nconst { t } = useI18n();\r\nconst gtm = useGtm();\r\nconst { show } = useModal(\"ProductCardModal\");\r\n\r\nconst quantity = ref(1);\r\nconst cartPrices = ref(null);\r\nconst cartItems = ref(null);\r\nconst isAddToCartBtnDisabled = ref(false);\r\n\r\nconst product = computed(() => store.getters[\"product/getCurrentProduct\"]);\r\n\r\nwatch(\r\n  () => product.value,\r\n  (newProduct) => {\r\n    if (newProduct) {\r\n      quantity.value = 1;\r\n    }\r\n  }\r\n);\r\n\r\nconst btnDisable = computed(() => {\r\n  if (props.product?.__typename == \"ConfigurableProduct\") {\r\n    const retval = store.getters[\"product/getCurrentChildSku\"];\r\n    if (retval != null) {\r\n      return false;\r\n    } else {\r\n      return true;\r\n    }\r\n  } else {\r\n    return false;\r\n  }\r\n});\r\n\r\nconst buttonClass = computed(() => {\r\n  if (btnDisable.value == true) {\r\n    return \"cursor: not-allowed;\";\r\n  } else {\r\n    return \"\";\r\n  }\r\n});\r\n\r\nconst quantityUp = () => {\r\n  quantity.value++;\r\n  props.addedQuantity(quantity.value);\r\n};\r\n\r\nconst quantityDown = () => {\r\n  if (quantity.value > 1) quantity.value--;\r\n  props.addedQuantity(quantity.value);\r\n};\r\n\r\nconst HrTrackCart = async () => {\r\n  cartPrices.value = await store.getters[\"cart/getCartPrices\"];\r\n  cartItems.value = await store.getters[\"cart/getCartItems\"];\r\n\r\n  const hritems = [];\r\n  cartItems.value.forEach((element) => {\r\n    hritems.push(element.product.sku);\r\n  });\r\n\r\n  self.ADDWISH_PARTNER_NS.api.cart.setCart(\r\n    {\r\n      total: cartPrices.value?.grand_total?.value,\r\n      productNumbers: hritems,\r\n    },\r\n    function () {\r\n      //Cart has been tracked for HR\r\n    }\r\n  );\r\n};\r\n\r\nconst addToCart = async () => {\r\n  try {\r\n    isAddToCartBtnDisabled.value = true;\r\n    switch (props.product.__typename) {\r\n      case \"SimpleProduct\": {\r\n        const item =\r\n          '{data: {sku: \"' +\r\n          props.product.sku +\r\n          '\", quantity:' +\r\n          quantity.value +\r\n          \"}}  \";\r\n        let retval = await store.dispatch(\"cart/addToCart\", {\r\n          type: props.product.__typename,\r\n          item: item,\r\n          store,\r\n        });\r\n        if (retval == false) {\r\n          const msg = {\r\n            type: \"danger\",\r\n            title: t(\"shopping_basket\"),\r\n            text: t(\"not_add_product\"),\r\n          };\r\n          store.dispatch(\"messages/sendMessage\", { message: msg });\r\n        } else {\r\n          if (config.helloRetail && config.helloRetail.enabled) {\r\n            HrTrackCart();\r\n          }\r\n\r\n          if (gtm.enabled()) {\r\n            window?.dataLayer.push({\r\n              event: \"eec.add\",\r\n              ecommerce: {\r\n                add: {\r\n                  products: [\r\n                    {\r\n                      name: props.product.name,\r\n                      id: props.product.sku,\r\n                      quantity: quantity.value,\r\n                    },\r\n                  ],\r\n                },\r\n              },\r\n            });\r\n          }\r\n          show();\r\n        }\r\n        break;\r\n      }\r\n      case \"ConfigurableProduct\": {\r\n        const item =\r\n          '{ parent_sku: \"' +\r\n          props.product.sku +\r\n          '\" data: {sku: \"' +\r\n          store.getters[\"product/getCurrentChildSku\"] +\r\n          '\", quantity:' +\r\n          quantity.value +\r\n          \"}}  \";\r\n        let retval = await store.dispatch(\"cart/addToCart\", {\r\n          type: props.product.__typename,\r\n          item: item,\r\n          store,\r\n        });\r\n        if (retval == false) {\r\n          const msg = {\r\n            type: \"danger\",\r\n            title: t(\"add_to_cart\"),\r\n            text: t(\"not_add_product\"),\r\n          };\r\n          store.dispatch(\"messages/sendMessage\", { message: msg });\r\n        } else {\r\n          if (config.helloRetail && config.helloRetail.enabled) {\r\n            HrTrackCart();\r\n          }\r\n\r\n          if (gtm.enabled()) {\r\n            window?.dataLayer.push({\r\n              event: \"eec.add\",\r\n              ecommerce: {\r\n                add: {\r\n                  products: [\r\n                    {\r\n                      name: props.product.name,\r\n                      id: props.product.sku,\r\n                      quantity: quantity.value,\r\n                    },\r\n                  ],\r\n                },\r\n              },\r\n            });\r\n          }\r\n          show();\r\n        }\r\n        break;\r\n      }\r\n\r\n      default:\r\n        break;\r\n    }\r\n  } catch (error) {\r\n    console.log(error);\r\n  } finally {\r\n    isAddToCartBtnDisabled.value = false;\r\n  }\r\n};\r\n</script>\r\n"],"names":["config"],"mappings":"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"}