{"version":3,"file":"forms-BxHSFE8a.js","sources":["../../../core/data-resolver/forms.js"],"sourcesContent":["import axios from \"axios\";\r\nimport config from \"@config\";\r\nimport { getCurrentLanguage } from \"@storefront/core/i18n\";\r\nimport { Logger } from \"@storefront/core/lib/logger\";\r\n//import store from \"@/store\";\r\n\r\n/**\r\n *\r\n * @param {string} type\r\n * @returns form object\r\n */\r\nexport async function loadForms(type) {\r\n  const lang = getCurrentLanguage();\r\n  const storelang = config.languages[lang];\r\n  const storeview = storelang[\"storeview\"];\r\n\r\n  const headers = {\r\n    \"Content-Type\": \"application/json\",\r\n    Authorization: \"Bearer \" + config.shop.accessToken,\r\n    Store: storeview,\r\n  };\r\n  const query =\r\n    \"query { form (type: \" +\r\n    type +\r\n    \") { title showFieldsetsAsPages fieldsets { title fields { label name value type inputType checkedValue uncheckedValue options validation { type additional } placeholder } } } }\";\r\n  const retval = await axios({\r\n    url: config.shop.graphQLURL + \"?query=\" + encodeURIComponent(query),\r\n    method: \"GET\",\r\n    headers: headers,\r\n  }).catch((e) => {\r\n    Logger.error(\"loadForms\", \"data-resolver forms\", e)();\r\n    throw e;\r\n  });\r\n  return retval.data?.data?.form;\r\n}\r\n\r\nexport async function sendForm(input) {\r\n  const lang = getCurrentLanguage();\r\n  const storelang = config.languages[lang];\r\n  const storeview = storelang[\"storeview\"];\r\n\r\n  const headers = {\r\n    \"Content-Type\": \"application/json\",\r\n    //Authorization: \"Bearer \" + config.shop.accessToken,\r\n    Store: storeview,\r\n  };\r\n\r\n  const query =\r\n    \"mutation{ submitForm(input: { \" +\r\n    input +\r\n    \" } ){ has_errors thank_you_message fields { name value errors { message } } } }\";\r\n  const retval = await axios({\r\n    url: config.shop.graphQLURL,\r\n    method: \"POST\",\r\n    headers: headers,\r\n    data: { query: query },\r\n  }).catch((e) => {\r\n    Logger.error(\"createGuestCart\", \"data-resolver carts\", e)();\r\n    console.log(e);\r\n    throw e;\r\n  });\r\n  if (retval.data.data.submitForm != null) {\r\n    return retval.data.data.submitForm;\r\n  } else {\r\n    return false;\r\n  }\r\n}\r\n"],"names":["config","Logger"],"mappings":";;AAWO,eAAe,UAAU,MAAM;;AACpC,QAAM,OAAO;AACb,QAAM,YAAYA,YAAO,UAAU,IAAI;AACvC,QAAM,YAAY,UAAU,WAAW;AAEvC,QAAM,UAAU;AAAA,IACd,gBAAgB;AAAA,IAChB,eAAe,YAAYA,YAAO,KAAK;AAAA,IACvC,OAAO;AAAA,EACX;AACE,QAAM,QACJ,yBACA,OACA;AACF,QAAM,SAAS,MAAM,MAAM;AAAA,IACzB,KAAKA,YAAO,KAAK,aAAa,YAAY,mBAAmB,KAAK;AAAA,IAClE,QAAQ;AAAA,IACR;AAAA,EACJ,CAAG,EAAE,MAAM,CAAC,MAAM;AACdC,WAAO,MAAM,aAAa,uBAAuB,CAAC,EAAC;AACnD,UAAM;AAAA,EACV,CAAG;AACD,UAAO,kBAAO,SAAP,mBAAa,SAAb,mBAAmB;AAC5B;AAEO,eAAe,SAAS,OAAO;AACpC,QAAM,OAAO;AACb,QAAM,YAAYD,YAAO,UAAU,IAAI;AACvC,QAAM,YAAY,UAAU,WAAW;AAEvC,QAAM,UAAU;AAAA,IACd,gBAAgB;AAAA;AAAA,IAEhB,OAAO;AAAA,EACX;AAEE,QAAM,QACJ,mCACA,QACA;AACF,QAAM,SAAS,MAAM,MAAM;AAAA,IACzB,KAAKA,YAAO,KAAK;AAAA,IACjB,QAAQ;AAAA,IACR;AAAA,IACA,MAAM,EAAE,MAAc;AAAA,EAC1B,CAAG,EAAE,MAAM,CAAC,MAAM;AACdC,WAAO,MAAM,mBAAmB,uBAAuB,CAAC,EAAC;AACzD,YAAQ,IAAI,CAAC;AACb,UAAM;AAAA,EACV,CAAG;AACD,MAAI,OAAO,KAAK,KAAK,cAAc,MAAM;AACvC,WAAO,OAAO,KAAK,KAAK;AAAA,EAC5B,OAAS;AACL,WAAO;AAAA,EACR;AACH;"}