{"version":3,"file":"login-N1PjRolI.js","sources":["../../../core/composable/login.js"],"sourcesContent":["import { useStore } from 'vuex';\r\nimport { useI18n } from 'vue-i18n';\r\n\r\n\r\nexport function useLogin() {\r\n    const store = useStore();\r\n    const { t } = useI18n();\r\n\r\n    const login = async (loginData) => {\r\n        const emailReg = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,24}))$/;\r\n        let valid = true;\r\n        let loginOk = false;\r\n        if (loginData.email === '') {\r\n            const msg = {\r\n                type: 'danger',\r\n                title: t('login_error'),\r\n                text: t('email_is_required_field'),\r\n            };\r\n            store.dispatch('messages/sendMessage', { message: msg });\r\n            valid = false;\r\n        } else if (!emailReg.test(loginData.email)) {\r\n            const msg = {\r\n                type: 'danger',\r\n                title: t('login_error'),\r\n                text: t('email_is_invalid_field'),\r\n            };\r\n            store.dispatch('messages/sendMessage', { message: msg });\r\n            valid = false;\r\n        }\r\n\r\n        if (loginData.password === '') {\r\n            const msg = {\r\n                type: 'danger',\r\n                title: t('login_error'),\r\n                text: t('password_is_required_field'),\r\n            };\r\n            store.dispatch('messages/sendMessage', { message: msg });\r\n            valid = false;\r\n        }\r\n\r\n        if (valid) {\r\n            loginOk = await store.dispatch('user/login', {\r\n                username: loginData.email,\r\n                password: loginData.password,\r\n                store\r\n            });\r\n            if (loginOk) {\r\n                const msg = {\r\n                    type: 'success',\r\n                    title: t('login_success'),\r\n                    text: t('you_are_logged_in'),\r\n                };\r\n                store.dispatch('messages/sendMessage', { message: msg });\r\n            }\r\n        }\r\n    };\r\n\r\n    return { login };\r\n}\r\n"],"names":[],"mappings":";;AAIO,SAAS,WAAW;AACvB,QAAM,QAAQ;AACd,QAAM,EAAE,MAAM;AAEd,QAAM,QAAQ,OAAO,cAAc;AAC/B,UAAM,WAAW;AACjB,QAAI,QAAQ;AACZ,QAAI,UAAU;AACd,QAAI,UAAU,UAAU,IAAI;AACxB,YAAM,MAAM;AAAA,QACR,MAAM;AAAA,QACN,OAAO,EAAE,aAAa;AAAA,QACtB,MAAM,EAAE,yBAAyB;AAAA,MACjD;AACY,YAAM,SAAS,wBAAwB,EAAE,SAAS,IAAK,CAAA;AACvD,cAAQ;AAAA,IACX,WAAU,CAAC,SAAS,KAAK,UAAU,KAAK,GAAG;AACxC,YAAM,MAAM;AAAA,QACR,MAAM;AAAA,QACN,OAAO,EAAE,aAAa;AAAA,QACtB,MAAM,EAAE,wBAAwB;AAAA,MAChD;AACY,YAAM,SAAS,wBAAwB,EAAE,SAAS,IAAK,CAAA;AACvD,cAAQ;AAAA,IACX;AAED,QAAI,UAAU,aAAa,IAAI;AAC3B,YAAM,MAAM;AAAA,QACR,MAAM;AAAA,QACN,OAAO,EAAE,aAAa;AAAA,QACtB,MAAM,EAAE,4BAA4B;AAAA,MACpD;AACY,YAAM,SAAS,wBAAwB,EAAE,SAAS,IAAK,CAAA;AACvD,cAAQ;AAAA,IACX;AAED,QAAI,OAAO;AACP,gBAAU,MAAM,MAAM,SAAS,cAAc;AAAA,QACzC,UAAU,UAAU;AAAA,QACpB,UAAU,UAAU;AAAA,QACpB;AAAA,MAChB,CAAa;AACD,UAAI,SAAS;AACT,cAAM,MAAM;AAAA,UACR,MAAM;AAAA,UACN,OAAO,EAAE,eAAe;AAAA,UACxB,MAAM,EAAE,mBAAmB;AAAA,QAC/C;AACgB,cAAM,SAAS,wBAAwB,EAAE,SAAS,IAAK,CAAA;AAAA,MAC1D;AAAA,IACJ;AAAA,EACT;AAEI,SAAO,EAAE,MAAK;AAClB;"}