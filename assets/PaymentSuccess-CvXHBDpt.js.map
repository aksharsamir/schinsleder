{"version":3,"file":"PaymentSuccess-CvXHBDpt.js","sources":["../../../src/esf_thehague_schinsleder/core/views/PaymentSuccess.vue"],"sourcesContent":["<template>\r\n    <AppLayout wrapperClass=\"paymentInfo\" v-if=\"isClient\">\r\n        <Breadcrumbs />\r\n        <section class=\"static cart pt-0 p-15\">\r\n            <h1>{{ $t(\"payment_success\") }}</h1>\r\n            <span class=\"success-text\" v-if=\"transactionId != null\"> {{ $t(\"transaction\", {\r\n                transactionId: transactionId\r\n                }) }}</span>\r\n            <div class=\"mt-15 btn-wrapper\">\r\n                <router-link :to=\"{ name: 'home' }\"\r\n                    class=\"me-15 py-3 btn btn-md btn-outline-secondary rounded-0\">{{ $t(\"continue_shopping\") }}</router-link>\r\n                <router-link :to=\"{ name: 'account' }\"\r\n                    class=\"py-3 btn btn-md btn-outline-secondary rounded-0\">{{ $t(\"my_account\") }}</router-link>\r\n            </div>\r\n        </section>\r\n    </AppLayout>\r\n</template>\r\n\r\n<script setup>\r\nimport { onMounted, ref, computed } from \"vue\";\r\nimport { useRouter, useRoute } from \"vue-router\";\r\nimport { useStore } from \"vuex\";\r\nimport { useI18n } from \"vue-i18n\";\r\nimport { useHead } from \"@unhead/vue\";\r\nimport AppLayout from \"@/esf_thehague_schinsleder/core/components/AppLayout\";\r\nimport Breadcrumbs from \"@/esf_thehague_schinsleder/core/components/Breadcrumbs\";\r\nimport { getOrderInfoFromHash } from \"@storefront/core/data-resolver/cart\";\r\nimport config from \"@storefront/core/lib/utils/config\";\r\nimport { useGtm } from \"@gtm-support/vue-gtm\";\r\n\r\nconst store = useStore();\r\nconst router = useRouter();\r\nconst route = useRoute();\r\nconst { t } = useI18n();\r\nconst gtm = useGtm();\r\nconst isClient = ref(false);\r\n\r\n// Set up meta information using useHead\r\nuseHead({\r\n    title: () => t(\"payment_success\"),\r\n    meta: [\r\n        { name: \"title\", content: () => t(\"payment_success\") },\r\n        { name: \"keywords\", content: () => t(\"payment_success\") },\r\n        { name: \"description\", content: () => t(\"payment_success\") },\r\n    ],\r\n});\r\n\r\n// orderId is not define\r\nconst orderId = ref(null);\r\nlet order = ref(null);\r\n\r\n// Computed properties\r\nconst transactionId = computed(() => {\r\n    return route.query.transactionid !== undefined ? route.query.transactionid : null;\r\n});\r\n\r\n// Mounted\r\nonMounted(async () => {\r\n    const bcrumb = { current: \"success\", routes: [] };\r\n    store.commit(\"breadcrumbs/set\", bcrumb);\r\n\r\n    const hashId = localStorage.getItem(\"orderHash\");\r\n    if (hashId) {\r\n        order.value = await getOrderInfoFromHash(hashId, store);\r\n        if (order.value) {\r\n            orderId.value = order.number;\r\n\r\n            if (gtm.enabled()) {\r\n                const items = [];\r\n                const prods = [];\r\n                order.value.items.forEach((element) => {\r\n                    items.push({\r\n                        id: element.product_sku,\r\n                        name: element.product_name,\r\n                        price: element.product_sale_price,\r\n                        quantity: element.quantity_ordered,\r\n                    });\r\n                    prods.push({\r\n                        item_id: element.product_sku,\r\n                        item_name: element.product_name,\r\n                        price: element.product_sale_price,\r\n                        quantity: element.quantity_ordered,\r\n                    });\r\n                });\r\n\r\n                if (!gtm.uaDisabled) {\r\n                    // GA Universal Analytics event\r\n                    window.dataLayer.push({\r\n                        event: \"purchase\",\r\n                        ecommerce: {\r\n                            currencyCode: \"EUR\",\r\n                            purchase: {\r\n                                actionField: {\r\n                                    id: order.value.number,\r\n                                    affiliation: config.app_name,\r\n                                    revenue: order.value.total.subtotal.value,\r\n                                    tax: order.value.total.total_tax.value,\r\n                                    shipping: order.value.total.total_shipping.value,\r\n                                },\r\n                                products: items,\r\n                            },\r\n                        },\r\n                    });\r\n                }\r\n\r\n                if (gtm.ga4Enabled) {\r\n                    // GA4 event\r\n                    window.dataLayer.push({\r\n                        event: \"purchase\",\r\n                        ecommerce: {\r\n                            add: {\r\n                                transaction_id: order.value.number,\r\n                                affiliation: config.app_name,\r\n                                value: order.value.total.subtotal.value,\r\n                                tax: order.value.total.total_tax.value,\r\n                                shipping: order.value.total.total_shipping.value,\r\n                                items: prods,\r\n                            },\r\n                        },\r\n                    });\r\n                }\r\n\r\n                if (config.helloRetail?.enabled) {\r\n                    const hritems = order.value.items.map((item) => item.product_sku);\r\n                    window.ADDWISH_PARTNER_NS.api.conversion.track_sale(\r\n                        {\r\n                            total: order.value.total.subtotal.value,\r\n                            orderNumber: order.value.number,\r\n                            productNumbers: hritems,\r\n                        },\r\n                        () => {\r\n                            // Conversion tracked for Hello Retail\r\n                        }\r\n                    );\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    isClient.value = true;\r\n\r\n});\r\n</script>"],"names":["config"],"mappings":"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"}